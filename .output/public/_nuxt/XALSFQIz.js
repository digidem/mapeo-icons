const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BPDvX2tQ.js","./DNd1LxcY.js","./entry.BPY7Jh9m.css","./index.CTtpNyjl.css"])))=>i.map(i=>d[i]);
import{e as P,m as z,g as D,h as H,r as b,x as V,n as q,y as F,c as $,a as f,t as M,j as G,F as T,z as W,q as O,w as L,s as R,b as S,A as J,o as w,B as K,C as Q,D as U,E as X}from"./DNd1LxcY.js";import{_ as Y}from"./BeKNZ3Ru.js";import{u as Z}from"./Z-lyZ3gd.js";class E{constructor(t,s,e){this.set(t,s,e)}toString(){return`rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})`}set(t,s,e){this.r=this.clamp(t),this.g=this.clamp(s),this.b=this.clamp(e)}hueRotate(t=0){t=t/180*Math.PI;const s=Math.sin(t),e=Math.cos(t);this.multiply([.213+e*.787-s*.213,.715-e*.715-s*.715,.072-e*.072+s*.928,.213-e*.213+s*.143,.715+e*.285+s*.14,.072-e*.072-s*.283,.213-e*.213-s*.787,.715-e*.715+s*.715,.072+e*.928+s*.072])}grayscale(t=1){this.multiply([.2126+.7874*(1-t),.7152-.7152*(1-t),.0722-.0722*(1-t),.2126-.2126*(1-t),.7152+.2848*(1-t),.0722-.0722*(1-t),.2126-.2126*(1-t),.7152-.7152*(1-t),.0722+.9278*(1-t)])}sepia(t=1){this.multiply([.393+.607*(1-t),.769-.769*(1-t),.189-.189*(1-t),.349-.349*(1-t),.686+.314*(1-t),.168-.168*(1-t),.272-.272*(1-t),.534-.534*(1-t),.131+.869*(1-t)])}saturate(t=1){this.multiply([.213+.787*t,.715-.715*t,.072-.072*t,.213-.213*t,.715+.285*t,.072-.072*t,.213-.213*t,.715-.715*t,.072+.928*t])}multiply(t){const s=this.clamp(this.r*t[0]+this.g*t[1]+this.b*t[2]),e=this.clamp(this.r*t[3]+this.g*t[4]+this.b*t[5]),o=this.clamp(this.r*t[6]+this.g*t[7]+this.b*t[8]);this.r=s,this.g=e,this.b=o}brightness(t=1){this.linear(t)}contrast(t=1){this.linear(t,-(.5*t)+.5)}linear(t=1,s=0){this.r=this.clamp(this.r*t+s*255),this.g=this.clamp(this.g*t+s*255),this.b=this.clamp(this.b*t+s*255)}invert(t=1){this.r=this.clamp((t+this.r/255*(1-2*t))*255),this.g=this.clamp((t+this.g/255*(1-2*t))*255),this.b=this.clamp((t+this.b/255*(1-2*t))*255)}hsl(){const t=this.r/255,s=this.g/255,e=this.b/255,o=Math.max(t,s,e),a=Math.min(t,s,e);let i,h;const g=(o+a)/2;if(o===a)i=h=0;else{const u=o-a;switch(h=g>.5?u/(2-o-a):u/(o+a),o){case t:i=(s-e)/u+(s<e?6:0);break;case s:i=(e-t)/u+2;break;case e:i=(t-s)/u+4;break}i/=6}return{h:i*100,s:h*100,l:g*100}}clamp(t){return t>255?t=255:t<0&&(t=0),t}}class tt{constructor(t){this.target=t,this.targetHSL=t.hsl(),this.reusedColor=new E(0,0,0)}solve(){const t=this.solveNarrow(this.solveWide());return{values:t.values,loss:t.loss,filter:this.css(t.values)}}solveWide(){const e=[60,180,18e3,600,1.2,1.2];let o={loss:1/0};for(let a=0;o.loss>25&&a<3;a++){const i=[50,20,3750,50,100,100],h=this.spsa(5,e,15,i,1e3);h.loss<o.loss&&(o=h)}return o}solveNarrow(t){const s=t.loss,e=2,o=s+1,a=[.25*o,.25*o,o,.25*o,.2*o,.2*o];return this.spsa(s,a,e,t.values,500)}spsa(t,s,e,o,a){const h=.16666666666666666;let g=null,u=1/0;const y=new Array(6),v=new Array(6),p=new Array(6);for(let n=0;n<a;n++){const l=e/Math.pow(n+1,h);for(let r=0;r<6;r++)y[r]=Math.random()>.5?1:-1,v[r]=o[r]+l*y[r],p[r]=o[r]-l*y[r];const c=this.loss(v)-this.loss(p);for(let r=0;r<6;r++){const k=c/(2*l)*y[r],C=s[r]/Math.pow(t+n+1,1);o[r]=_(o[r]-C*k,r)}const x=this.loss(o);x<u&&(g=o.slice(0),u=x)}return{values:g,loss:u};function _(n,l){let c=100;return l===2?c=7500:(l===4||l===5)&&(c=200),l===3?n>c?n%=c:n<0&&(n=c+n%c):n<0?n=0:n>c&&(n=c),n}}loss(t){const s=this.reusedColor;s.set(0,0,0),s.invert(t[0]/100),s.sepia(t[1]/100),s.saturate(t[2]/100),s.hueRotate(t[3]*3.6),s.brightness(t[4]/100),s.contrast(t[5]/100);const e=s.hsl();return Math.abs(s.r-this.target.r)+Math.abs(s.g-this.target.g)+Math.abs(s.b-this.target.b)+Math.abs(e.h-this.targetHSL.h)+Math.abs(e.s-this.targetHSL.s)+Math.abs(e.l-this.targetHSL.l)}css(t){function s(e,o=1){return Math.round(t[e]*o)}return`filter: invert(${s(0)}%) sepia(${s(1)}%) saturate(${s(2)}%) hue-rotate(${s(3,3.6)}deg) brightness(${s(4)}%) contrast(${s(5)}%);`}}function st(m){const t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;m=m.replace(t,(e,o,a,i)=>o+o+a+a+i+i);const s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(m);return s?[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16)]:null}const et=m=>{const t=st(m);if(t.length!==3){alert("Invalid format!");return}const s=new E(t[0],t[1],t[2]);return new tt(s).solve().filter},ot={class:"relative flex items-top justify-center min-h-screen bg-gray-100 sm:items-center sm:pt-0"},rt={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},nt={class:"flex justify-center pt-8 sm:pt-0",href:"https://mapeo.app",target:"_blank"},at={class:"text-2xl"},it={class:"mt-8 bg-white overflow-hidden shadow sm:rounded-lg p-6 pb-500px md:pb-0"},lt={class:"flex flex-row flex-wrap justify-center"},ct=["onClick"],ht=["src"],dt={key:0,class:"text-red-500 py-4 text-center"},ut={class:"flex flex-col text-gray-800 md:border-t md:border-dashed fixed right-0.5 left-0.5 md:static bottom-4 md:bottom-0 md:flex-row md:justify-around items-center"},pt={class:"w-250px uppercase bg-yellow-400 py-4 px-8 rounded-xl"},ft=["disabled"],mt={class:"flex justify-center py-4"},gt=["disabled"],$t=P({__name:"images",async setup(m){let t,s;const e=U(()=>X(()=>import("./BPDvX2tQ.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),o=z(),a=D(),i=H(),h=o.query.s||"",g=o.query.l||"en",u=b(h),{data:y,error:v}=([t,s]=V(()=>Z(`/api/search?s=${h}&l=${g}`,"$vR5ECL7_o3")),t=await t,s(),t),p=b(Array.isArray(y.value)?y.value:[]),_=b(null),n=b(!1),l=b(!1),c=b(!1),x=b(1),r=b({hex:"#194d33",rgba:{r:25,g:77,b:51,a:1},hsv:{h:146,s:68,v:30}}),k=q(()=>et(r.value?.hex));F(()=>{v.value?a.push(i("/?error=true")):Array.isArray(p.value)&&p.value.length>0&&(_.value=p.value[0])});const C=d=>{r.value=d},I=()=>{_.value&&(n.value=!0,a.push(i(`/result?image=${_.value}&color=${r.value.hex.split("#")[1]}&search=${u.value}`)))},j=async()=>{l.value=!0,x.value=x.value+1;try{const d=await $fetch(`/api/search?s=${h}&l=${g}&p=${x.value}`);Array.isArray(p.value)&&Array.isArray(d)&&(p.value=[...p.value,...d]),l.value=!1}catch{l.value=!1,c.value=!0}};return(d,_t)=>{const B=Y,N=J;return w(),$("div",ot,[f("div",rt,[f("a",nt,[f("h1",at,M(d.$t("select-icon")),1)]),f("div",it,[f("div",lt,[(w(!0),$(T,null,W(p.value,A=>(w(),$("div",{key:A,class:Q(`p-25px cursor-pointer border-red-500 border-solid rounded ${_.value===A?"border-2":"border-0"}`),style:K(k.value),onClick:bt=>_.value=A},[f("img",{width:"100",src:A},null,8,ht)],14,ct))),128))]),c.value?(w(),$("p",dt,M(d.$t("loadingMoreError"))+"! ",1)):G("",!0),f("div",ut,[c.value?(w(),O(B,{key:0,to:R(i)("/")},{default:L(()=>[f("button",pt,M(d.$t("search-again")),1)]),_:1},8,["to"])):(w(),$("button",{key:1,disabled:l.value,class:"w-250px uppercase bg-gray-900 py-4 px-8 rounded-xl text-light-700",onClick:j},M(d.$t(l.value?"loading":"load-more")),9,ft)),f("div",mt,[S(N,null,{default:L(()=>[S(R(e),{color:r.value.hex,onChangeColor:C},null,8,["color"])]),_:1})]),f("button",{disabled:n.value||!_.value,class:"w-250px uppercase bg-green-400 py-4 px-8 rounded-xl",onClick:I},M(d.$t(n.value?"loading":"generate")),9,gt)])])])])}}});export{$t as default};
